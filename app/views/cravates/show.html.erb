<% content_for :page_class, "berthier-cravate-show" %>

<!-- Breadcrumb -->
<nav class="breadcrumb">
  <div class="container">
    <%= link_to "â† Retour au catalogue", cravates_path, class: "breadcrumb__link" %>
  </div>
</nav>

<!-- Fiche Produit -->
<section class="product-detail">
  <div class="container">
    <!-- En-tÃªte style dossier administratif -->
    <header class="product-detail__dossier-header">
      <span class="dossier__ref">DOSSIER <%= @cravate.reference %></span>
      <span class="dossier__service">SERVICE CRAVATES â€” CLASSEMENT CONFIDENTIEL</span>
    </header>

    <div class="product-detail__grid">
      <!-- Colonne gauche : Image -->
      <div class="product-detail__gallery">
        <div class="product-detail__main-image">
          <% if @cravate.photos.attached? %>
            <%= image_tag @cravate.photos.first, alt: @cravate.name %>
          <% else %>
            <div class="product-img-placeholder--large">
              <span class="placeholder-icon">ğŸ‘”</span>
              <span class="placeholder-ref"><%= @cravate.reference %></span>
            </div>
          <% end %>

          <!-- Tampon APPROUVÃ‰ si en stock -->
          <% if @cravate.available? %>
            <div class="product-detail__stamp">
              APPROUVÃ‰
            </div>
          <% end %>
        </div>
      </div>

      <!-- Colonne droite : Infos -->
      <div class="product-detail__info">
        <div class="product-detail__header">
          <span class="product-detail__ref"><%= @cravate.reference %></span>
          <h1 class="product-detail__name"><%= @cravate.name %></h1>
          <p class="product-detail__color"><%= @cravate.color %></p>
        </div>

        <!-- Bloc prix -->
        <div class="product-detail__price-block">
          <span class="product-detail__price"><%= number_to_currency(@cravate.price, unit: "â‚¬", format: "%n%u") %></span>
          <% if @cravate.available? %>
            <span class="product-detail__stock product-detail__stock--available">En stock (<%= @cravate.stock %> disponibles)</span>
          <% else %>
            <span class="product-detail__stock product-detail__stock--out">Rupture de stock</span>
          <% end %>
        </div>

        <!-- Description courte -->
        <p class="product-detail__description"><%= @cravate.description %></p>

        <!-- Actions -->
        <div class="product-detail__actions">
          <% if @cravate.available? %>
            <button class="btn btn--full btn--large">
              ğŸ‘” Ajouter au dossier â€” <%= number_to_currency(@cravate.price, unit: "â‚¬", format: "%n%u") %>
            </button>
          <% else %>
            <div class="product-detail__notify">
              <p>Cette cravate est temporairement indisponible.</p>
              <button class="btn btn--outline">Me prÃ©venir du retour</button>
            </div>
          <% end %>
        </div>

        <!-- Engagements -->
        <div class="product-detail__engagement">
          <div class="engagement__item">
            <span class="engagement__icon">ğŸŒ±</span>
            <span>100% Lin bio franÃ§ais</span>
          </div>
          <div class="engagement__item">
            <span class="engagement__icon">âœŠ</span>
            <span>10% reversÃ©s Ã  des associations fÃ©ministes</span>
          </div>
          <div class="engagement__item">
            <span class="engagement__icon">ğŸ¤</span>
            <span>Confection solidaire ESS</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Bloc Narratif - 3 fiches horizontales -->
<section class="product-narrative">
  <div class="container">
    <div class="narrative__grid">
      <!-- Fiche 1 : L'Histoire -->
      <% if @cravate.story.present? %>
        <article class="narrative__card narrative__card--story">
          <div class="narrative__card-header">
            <span class="narrative__icon">ğŸ“</span>
            <h2 class="narrative__title">L'Histoire</h2>
          </div>
          <p class="narrative__content"><%= @cravate.story %></p>
        </article>
      <% end %>

      <!-- Fiche 2 : Quand la porter -->
      <% if @cravate.when_to_wear.present? %>
        <article class="narrative__card narrative__card--when">
          <div class="narrative__card-header">
            <span class="narrative__icon">ğŸ“Œ</span>
            <h2 class="narrative__title">Quand la porter</h2>
          </div>
          <p class="narrative__content"><%= @cravate.when_to_wear %></p>
        </article>
      <% end %>

      <!-- Fiche 3 : Le mot de Berthier -->
      <% if @cravate.berthier_quote.present? %>
        <article class="narrative__card narrative__card--quote">
          <div class="narrative__card-header">
            <span class="narrative__icon">ğŸ’¬</span>
            <h2 class="narrative__title">Le mot de Berthier</h2>
          </div>
          <blockquote class="narrative__quote">
            "<%= @cravate.berthier_quote %>"
          </blockquote>
          <cite class="narrative__signature">â€” Berthier, Service ComptabilitÃ©, 1994-2016</cite>
        </article>
      <% end %>
    </div>
  </div>
</section>

<!-- SpÃ©cifications techniques -->
<section class="product-specs-section">
  <div class="container">
    <div class="product-specs__wrapper">
      <h3 class="product-specs__title">ğŸ“‹ SpÃ©cifications Techniques</h3>
      <div class="product-specs__grid">
        <div class="spec__item">
          <span class="spec__label">MatiÃ¨re</span>
          <span class="spec__value"><%= @cravate.material %></span>
        </div>
        <div class="spec__item">
          <span class="spec__label">Largeur</span>
          <span class="spec__value">7,5 cm</span>
        </div>
        <div class="spec__item">
          <span class="spec__label">Longueur</span>
          <span class="spec__value">145 cm</span>
        </div>
        <div class="spec__item">
          <span class="spec__label">Confection</span>
          <span class="spec__value">Ateliers ESS, France</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Citation de fin -->
<section class="product-quote">
  <div class="container">
    <p class="product-quote__text">"Une cravate, c'est un contrat tacite avec le monde du travail. Autant qu'il soit Ã©crit avec ironie."</p>
    <p class="product-quote__signature">â€” Berthier, Manifeste fondateur, 1994</p>
  </div>
</section>

<!-- Autres cravates -->
<section class="other-products">
  <div class="container">
    <h2 class="section-title">AUTRES DOSSIERS</h2>
    <div class="other-products__grid">
      <% @other_cravates.each do |cravate| %>
        <%= link_to cravate_path(cravate), class: "other-product-card" do %>
          <div class="other-product-card__img">
            <% if cravate.photos.attached? %>
              <%= image_tag cravate.photos.first, alt: cravate.name %>
            <% else %>
              <div class="other-product-img-placeholder">ğŸ‘”</div>
            <% end %>
          </div>
          <div class="other-product-card__info">
            <h3><%= cravate.name %></h3>
            <span class="other-product-card__price"><%= number_to_currency(cravate.price, unit: "â‚¬", format: "%n%u") %></span>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
